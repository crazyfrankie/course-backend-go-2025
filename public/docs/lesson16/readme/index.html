<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="zh-cn" class="no-js">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="icon" href="/favicon.png" type="image/png">

<title>负载均衡 | Go 后端开发教程</title>
<meta name="description" content="负载均衡">
<meta property="og:url" content="http://localhost:1313/docs/lesson16/readme/">
  <meta property="og:site_name" content="Go 后端开发教程">
  <meta property="og:title" content="负载均衡">
  <meta property="og:description" content="负载均衡">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:modified_time" content="2025-09-02T16:00:08+08:00">

  <meta itemprop="name" content="负载均衡">
  <meta itemprop="description" content="负载均衡">
  <meta itemprop="dateModified" content="2025-09-02T16:00:08+08:00">
  <meta itemprop="wordCount" content="289">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="负载均衡">
  <meta name="twitter:description" content="负载均衡">
<link href="/scss/main.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><image href="/favicon.ico" width="32" height="32"/></svg></span><span class="navbar-brand__name">Go 后端开发教程</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/"><span>课程首页</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/docs/"><span>课程文档</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/CrazyForCode/course-backend-go-2025" target="_blank" rel="noopener"><span>GitHub</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="td-sidebar-nav collapse" id="td-section-nav">
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li">
  <a href="/docs/" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docs"><span class="">课程文档</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson00e4bb8e-0-e5bc80e5a78be5ada6-go-li">
  <a href="/docs/lesson00/%E4%BB%8E-0-%E5%BC%80%E5%A7%8B%E5%AD%A6-go/" title="从 0 开始学 Go" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson00e4bb8e-0-e5bc80e5a78be5ada6-go"><span class="">第0课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson01cfc-golange7acace4b880e88a82e8afbe-li">
  <a href="/docs/lesson01/cfc-golang%E7%AC%AC%E4%B8%80%E8%8A%82%E8%AF%BE/" title="基础语法" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson01cfc-golange7acace4b880e88a82e8afbe"><span class="">第1课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson0202-li">
  <a href="/docs/lesson02/02/" title="数组和切片" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson0202"><span class="">第2课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson03e7acace4b889e591a8e8afbee4bbb6-li">
  <a href="/docs/lesson03/%E7%AC%AC%E4%B8%89%E5%91%A8%E8%AF%BE%E4%BB%B6/" title="包、指针、结构体和接口" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson03e7acace4b889e591a8e8afbee4bbb6"><span class="">第3课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson04e5908ee7abaf-go-e7acace59b9be6aca1e8afbe-li">
  <a href="/docs/lesson04/%E5%90%8E%E7%AB%AF-go-%E7%AC%AC%E5%9B%9B%E6%AC%A1%E8%AF%BE/" title="后端 Go 第四次课" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson04e5908ee7abaf-go-e7acace59b9be6aca1e8afbe"><span class="">第4课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson05e5b9b6e58f91-li">
  <a href="/docs/lesson05/%E5%B9%B6%E5%8F%91/" title="并发编程" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson05e5b9b6e58f91"><span class="">第5课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson06readme-li">
  <a href="/docs/lesson06/readme/" title="HTTP 服务简单案例" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson06readme"><span class="">第6课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson07lesson7-li">
  <a href="/docs/lesson07/lesson7/" title="MySQL 数据库" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson07lesson7"><span class="">第7课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson08readme-li">
  <a href="/docs/lesson08/readme/" title="Redis 和 MongoDB" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson08readme"><span class="">第8课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson09readme-li">
  <a href="/docs/lesson09/readme/" title="第九课" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson09readme"><span class="">第9课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson10docker-li">
  <a href="/docs/lesson10/docker/" title="Docker 容器化" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson10docker"><span class="">第10课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson11readme-li">
  <a href="/docs/lesson11/readme/" title="单体架构实战" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson11readme"><span class="">第11课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson12e6b688e681afe9989fe58897-li">
  <a href="/docs/lesson12/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" title="第十二课" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson12e6b688e681afe9989fe58897"><span class="">第12课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson13lesson13-li">
  <a href="/docs/lesson13/lesson13/" title="微服务入门" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson13lesson13"><span class="">第13课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson14lesson14-li">
  <a href="/docs/lesson14/lesson14/" title="Go-zero 微服务" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson14lesson14"><span class="">第14课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson15readme-li">
  <a href="/docs/lesson15/readme/" title="第十五课" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson15readme"><span class="">第15课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docslesson16readme-li">
  <a href="/docs/lesson16/readme/" title="负载均衡" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id="m-docslesson16readme"><span class="td-sidebar-nav-active-item">第16课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson17e5908ee7abaf-go-e7acace58d81e4b883e6aca1e8afbe-li">
  <a href="/docs/lesson17/%E5%90%8E%E7%AB%AF-go-%E7%AC%AC%E5%8D%81%E4%B8%83%E6%AC%A1%E8%AF%BE/" title="第十七课" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson17e5908ee7abaf-go-e7acace58d81e4b883e6aca1e8afbe"><span class="">第17课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson18e58886e5b883e5bc8fe59fbae7a180-li">
  <a href="/docs/lesson18/%E5%88%86%E5%B8%83%E5%BC%8F%E5%9F%BA%E7%A1%80/" title="第十八课" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson18e58886e5b883e5bc8fe59fbae7a180"><span class="">第18课</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docslesson09example2baidu-li">
  <a href="/docs/lesson09/example2/baidu/" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id="m-docslesson09example2baidu"><span class=""></span></a>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">
<a href="https://github.com/CrazyForCode/course-backend-go-2025/tree/main/content/docs/lesson16/README.md" class="td-page-meta--view td-page-meta__view" target="_blank" rel="noopener"><i class="fa-solid fa-file-lines fa-fw"></i> 查看页面源码</a>
  <a href="https://github.com/CrazyForCode/course-backend-go-2025/edit/main/content/docs/lesson16/README.md" class="td-page-meta--edit td-page-meta__edit" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> 编辑此页</a>
  <a href="https://github.com/CrazyForCode/course-backend-go-2025/new/main/content/docs/lesson16?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" class="td-page-meta--child td-page-meta__child" target="_blank" rel="noopener"><i class="fa-solid fa-pen-to-square fa-fw"></i> 添加子页面</a>
  <a href="https://github.com/CrazyForCode/course-backend-go-2025/issues/new?title=%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1" class="td-page-meta--issue td-page-meta__issue" target="_blank" rel="noopener"><i class="fa-solid fa-list-check fa-fw"></i> 提交文档问题</a>
  
</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#负载均衡">负载均衡</a></li>
        <li><a href="#反向代理">反向代理</a></li>
        <li><a href="#限流-熔断-降级">限流 熔断 降级</a></li>
        <li><a href="#nginx">Nginx</a></li>
        <li><a href="#traefik">Traefik</a></li>
        <li><a href="#kong">Kong</a></li>
        <li><a href="#nginxconf">Nginx.conf</a></li>
        <li><a href="#作业">作业</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    
            

          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/docs/">课程文档</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    第16课</li>
  </ol>
</nav>
<div class="td-content">
	<h1>负载均衡</h1>
	<div class="lead">负载均衡</div>
	<header class="article-meta">
		
</header>
	<h1 id="第十六节课">第十六节课</h1>
<h3 id="负载均衡">负载均衡</h3>
<hr>
<p>负载均衡（Load Balance，简称 LB）是高并发、高可用系统必不可少的关键组件，目标是 尽力将网络流量平均分发到多个服务器上，以提高系统整体的响应速度和可用性。</p>
<p><strong>负载均衡的主要作用如下：</strong></p>
<p><strong>高并发</strong>：负载均衡通过算法调整负载，尽力均匀的分配应用集群中各节点的工作量，以此提高应用集群的并发处理能力（吞吐量）。</p>
<p><strong>伸缩性</strong>：添加或减少服务器数量，然后由负载均衡进行分发控制。这使得应用集群具备伸缩性。</p>
<p><strong>高可用</strong>：负载均衡器可以监控候选服务器，当服务器不可用时，自动跳过，将请求分发给可用的服务器。这使得应用集群具备高可用的特性。</p>
<h3 id="反向代理">反向代理</h3>
<hr>
<p>反向代理（Reverse Proxy）方式是指以 代理服务器 来接受网络请求，然后 将请求转发给内网中的服务器，并将从内网中的服务器上得到的结果返回给网络请求的客户端。</p>
<p>与反向代理相对的就是正向代理。</p>
<p>正向代理：发生在 <strong>客户端</strong>，是由用户主动发起的。vpn 软件就是典型的正向代理，客户端通过主动访问代理服务器，让代理服务器获得需要的外网数据，然后转发回客户端。</p>
<p>反向代理：发生在 <strong>服务端</strong>，用户不知道代理的存在。</p>
<p>nginx就是反向代理的一个主流产品。</p>
<h3 id="限流-熔断-降级">限流 熔断 降级</h3>
<hr>
<p>在分布式系统中，<strong>熔断</strong>、<strong>限流</strong>和<strong>服务降级</strong>是关键的容错设计模式，用于保护系统免受突发流量、故障或性能问题的影响。</p>
<p>让我们深入了解这些概念：</p>
<ol>
<li>
<p><strong>限流</strong>：</p>
<ul>
<li>当系统的处理能力无法应对外部请求的突发流量时，为了避免系统崩溃，必须采取限流措施。</li>
<li>限流指标可以是：
<ul>
<li><strong>TPS</strong>（每秒事务数）：按事务完成数量来限制流量。</li>
<li><strong>HPS</strong>（每秒请求数）：服务端每秒收到的客户端请求数量。</li>
<li><strong>QPS</strong>（每秒查询请求数）：服务端每秒响应的客户端查询数量。</li>
</ul>
</li>
<li>常用的限流方法包括流量计数器、滑动时间窗口、漏桶算法和令牌桶算法。</li>
</ul>
</li>
<li>
<p><strong>熔断</strong>：</p>
<ul>
<li>当流量过大或下游服务出现问题时，熔断会自动断开与下游服务的交互，以避免影响整个系统。</li>
<li>熔断可以自我恢复，通过自我诊断下游系统是否已修复或上游流量是否减少至正常水平来判断。</li>
</ul>
</li>
<li>
<p><strong>服务降级</strong>：</p>
<ul>
<li>
<p>降级是从系统内部的平级服务或业务维度考虑，用于保护其他正常使用的功能。</p>
</li>
<li>
<p>当服务出现问题或影响核心流程性能时，需要暂时屏蔽掉，待高峰或问题解决后再打开。</p>
</li>
</ul>
</li>
</ol>
<blockquote>
<p>3者的关系这样理解：
拿下棋比喻：
限流： 相当于尽量避免同时和两三个人同时下
熔断：相当于你的一颗卒被围死了，就不要利用其它棋去救它了，弃卒保帅，否则救他的棋也可能被拖死
降级：相当于尽量不要走用处不大的棋了，浪费走棋机会（资源），使已经过河的棋有更多的走棋机会（资源）发挥最大作用</p></blockquote>
<p>kitex中使用 <a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/loadbalance/">负载均衡</a> <a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/circuitbreaker/">熔断</a> <a href="https://www.cloudwego.io/zh/docs/kitex/tutorials/service-governance/limiting/">限流</a></p>
<p><strong>Sentinel</strong> 是一款面向分布式服务架构的轻量级流量控制产品</p>
<p>Sentinel 的主要特点：</p>
<ol>
<li><strong>流量控制</strong>：Sentinel 可以限制外部请求的流量，防止系统因突发流量而崩溃。</li>
<li><strong>实时监控</strong>：它提供实时监控功能，您可以在控制台中查看接入应用的运行情况。</li>
<li><strong>开源生态</strong>：Sentinel 可以与其他开源框架/库（如 Spring Cloud、Dubbo、gRPC）整合。</li>
</ol>
<p><a href="https://sentinelguard.io/zh-cn/docs/golang/quick-start.html">sentinel文档</a></p>
<h3 id="nginx">Nginx</h3>
<hr>
<p>Nginx 是一个高性能、开源的HTTP服务器和反向代理服务器。它可以作为一个独立的 Web 服务器，也可以作为其他 Web 服务器的反向代理。Nginx以其出色的性能和高度的可扩展性而闻名，是许多高流量网站的首选服务器。</p>
<p>Nginx 的特点包括：</p>
<ul>
<li>高性能：Nginx 采用事件驱动的方式处理请求，可以处理大量的并发请求。</li>
<li>可扩展性：Nginx 可以通过添加模块来扩展其功能，支持各种第三方模块。</li>
<li>反向代理：Nginx 可以作为反向代理服务器，可以隐藏真实服务器的地址，从而提高网络安全性。</li>
<li>负载均衡：Nginx 可以实现负载均衡，可以将请求分配到多个服务器上，从而提高网站的性能和可靠性。</li>
</ul>
<p>Nginx是一个功能强大而灵活的服务器，适合用于构建高性能、可扩展的Web应用程序。</p>
<p>在Nginx中实现反向代理非常简单。只需要在Nginx配置文件中添加一个<code>proxy_pass</code>指令即可。例如，要将所有<code>/api</code>请求代理到<code>http://localhost:3000</code>，可以使用以下配置：</p>
<pre tabindex="0"><code>location /api {
    proxy_pass &lt;http://localhost:3000&gt;;
}
</code></pre><p>这将使Nginx将所有<code>/api</code>请求代理到<code>http://localhost:3000</code>。在这个例子中，Nginx充当了客户端和服务器之间的中转站，将所有请求代理到真实的服务器上，然后将响应返回给客户端。</p>
<p>除了<code>proxy_pass</code>指令之外，Nginx 还提供了许多其他的反向代理指令，包括：</p>
<ul>
<li><code>proxy_set_header</code>：设置 HTTP 请求头。</li>
<li><code>proxy_redirect</code>：重定向代理请求。</li>
<li><code>proxy_cache</code>：缓存代理请求的响应。</li>
<li><code>proxy_connect_timeout</code>：设置代理连接超时时间。</li>
</ul>
<p>通过使用这些指令，可以轻松地配置 Nginx 作为反向代理服务器，并提供高性能、可扩展的 Web 应用程序。</p>
<h3 id="traefik">Traefik</h3>
<hr>
<p>Traefik 是一款现代的、基于容器的反向代理和负载均衡器。它可以自动发现容器、自动配置路由和 HTTPS 证书，并提供了许多其他的高级功能，如动态配置、健康检查和访问日志记录等。</p>
<p>Traefik 的特点包括：</p>
<ul>
<li>自动化：Traefik 可以自动发现容器，并自动配置路由和 HTTPS 证书。它还可以自动调整流量，将请求分配到最少的容器上，并在容器出现问题时自动将流量转移到健康的容器上。</li>
<li>动态配置：Traefik 支持动态配置，可以通过 REST API 或文件变更自动配置路由和负载均衡策略。它还支持多种后端服务，如 Docker、Kubernetes、Mesos、Consul 等。</li>
<li>高可用性：Traefik 可以实现高可用性，可以将请求分配到多个 Traefik 实例上，从而实现负载均衡和故障转移。</li>
<li>访问日志记录：Traefik 可以记录访问日志，并将其发送到各种日志记录服务中。</li>
</ul>
<p>Traefik的配置文件非常简单，可以使用以下格式：</p>
<pre tabindex="0"><code># traefik.toml
[entryPoints]
  [entryPoints.http]
  address = &#34;:80&#34;

[api]
  dashboard = true

[docker]
  endpoint = &#34;unix:///var/run/docker.sock&#34;
  domain = &#34;example.com&#34;
</code></pre><p>这将启用 Traefik 的 API 和仪表板，并配置 Traefik 使用 Docker 作为后端服务。</p>
<p>通过使用 Traefik，可以轻松地实现反向代理和负载均衡，并提供高可用性、动态配置和访问日志记录等高级功能。</p>
<p><a href="https://www.traefik.tech/">Traefik文档</a></p>
<h3 id="kong">Kong</h3>
<hr>
<p>Kong 是一个高性能的API网关，它可以管理微服务架构中的API通信。</p>
<ul>
<li><strong>核心组件</strong>：Kong 的主要组件包括 Kong Server（基于 nginx 的服务器，用来接收API请求）、数据库（Apache Cassandra 或 PostgreSQL，用来存储操作数据）以及 Kong dashboard（官方推荐的UI管理工具）。</li>
<li><strong>插件系统</strong>：Kong 通过插件来扩展其功能，这些插件可以在API请求响应循环的生命周期中被执行。插件使用Lua编写，目前已有多个基础功能插件，如HTTP基本认证、密钥认证、CORS、TCP、UDP、文件日志、API请求限流、请求转发以及Nginx监控。</li>
<li><strong>可扩展性</strong>：Kong 可以通过简单地添加更多的服务器来进行横向扩展，这意味着它可以在较低负载的情况下处理任何请求。</li>
<li><strong>模块化</strong>：Kong 的模块化设计允许通过添加新的插件进行扩展，这些插件可以通过 RESTful Admin API轻松配置。</li>
<li><strong>跨基础架构运行</strong>：Kong 可以在云或内部网络环境中部署，包括单个或多个数据中心设置，以及 public、private 或 invite-only APIs。</li>
<li><strong>集群和高可用性</strong>：Kong 支持集群部署，集群中的节点通过 gossip 协议自动发现其他节点。当通过一个 Kong 节点的管理API进行变更时，也会通知其他节点。</li>
</ul>
<p><a href="https://docs.konghq.com/">Kong文档</a></p>
<h3 id="nginxconf">Nginx.conf</h3>
<hr>
<p>删除注释长这样</p>
<pre tabindex="0"><code>worker_processes  1;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    
    keepalive_timeout  65;

    server {
        listen       80;
        server_name  localhost;

        location / {
            root   html;
            index  index.html index.htm;
        }


        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }
}
</code></pre><p>结构</p>
<pre tabindex="0"><code>...              #全局块

events {         #events块
   ...
}

http      #http块
{
    ...   #http全局块
    server        #server块
    { 
        ...       #server全局块
        location [PATTERN]   #location块
        {
            ...
        }
        location [PATTERN] 
        {
            ...
        }
    }
    server
    {
      ...
    }
    ...     #http全局块
}
</code></pre><p>1、<strong>全局块</strong>：配置影响nginx全局的指令。一般有运行nginx服务器的用户组，nginx进程pid存放路径，日志存放路径，配置文件引入，允许生成worker process数等。</p>
<p>2、<strong>events块</strong>：配置影响nginx服务器或与用户的网络连接。有每个进程的最大连接数，选取哪种事件驱动模型处理连接请求，是否允许同时接受多个网路连接，开启多个网络连接序列化等。</p>
<p>3、<strong>http块</strong>：可以嵌套多个server，配置代理，缓存，日志定义等绝大多数功能和第三方模块的配置。如文件引入，mime-type定义，日志自定义，是否使用sendfile传输文件，连接超时时间，单连接请求数等。</p>
<p>4、<strong>server块</strong>：配置虚拟主机的相关参数，一个http中可以有多个server。</p>
<p>5、<strong>location块</strong>：配置请求的路由，以及各种页面的处理情况。</p>
<h3 id="作业">作业</h3>
<p>lv1:尝试在自己的项目中实现负载均衡，限流或者熔断</p>
<p>lv2:在docker中用nginx模拟实现负载均衡，涉及到网络部分可自行学习docker network</p>

	<div class="td-page-meta__lastmod">
  最后修改 September 2, 2025: <a data-proofer-ignore href="https://github.com/CrazyForCode/course-backend-go-2025/commit/2c55f5392a0d27ce3b6279a2809f0669b76367c2">fix:fix lesson 15~18 (2c55f53)</a>
</div>

</div>


          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/CrazyForCode/course-backend-go-2025" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/CrazyForCode/course-backend-go-2025" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.js"></script>
<script defer src="/js/click-to-copy.js" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>